

<!DOCTYPE html>


<html lang="es" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Análisis frecuencial de señales usando ventanas &#8212; Laboratorio de Procesamineto Digital de Señales</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'recursos/nuevo_material/transf fourier discreta';</script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="es"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Saltar al contenido principal</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Laboratorio de Procesamineto Digital de Señales</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    Material de Laboratorio de Procesamiento Digital de Señales
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../guia_instalacion_python.html">Guía de instalación de las herramientas computacionales</a></li>
<li class="toctree-l1"><a class="reference internal" href="senales_discretas.html">Señales en tiempo discreto</a></li>
<li class="toctree-l1"><a class="reference internal" href="respuesta_sistemas_LTI_TD.html">Respuesta de Sistemas LTI en Tiempo Discreto</a></li>
<li class="toctree-l1"><a class="reference internal" href="correlacion.html">Correlación en tiempo discreto</a></li>
<li class="toctree-l1"><a class="reference internal" href="analisis_frecuencial_en_tiempo_discreto.html">Análisis frecuencial de señales en tiempo discreto</a></li>
<li class="toctree-l1"><a class="reference internal" href="diapo_sistemas/diapoSistemas.html">Sistemas dinámicos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cuadernos_clases/01-sampleo_tono_puro.html">Cuaderno clase 1</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Descarga esta pagina">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/recursos/nuevo_material/transf fourier discreta.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Descargar archivo fuente"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimir en PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modo de pantalla completa"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="claro/oscuro" aria-label="claro/oscuro" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Análisis frecuencial de señales usando ventanas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenido </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computo-de-la-transformada-de-fourier-en-tiempo-discreto-para-senales-de-longitud-finita">Cómputo de la Transformada de Fourier en Tiempo Discreto para señales de longitud finita</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformada-ideal">Transformada ideal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformada-discreta-de-fourier">Transformada Discreta de Fourier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformada-rapida-de-fourier-fft-fast-fourier-transform">Transformada Rápida de Fourier (FFT: Fast Fourier Transform)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#uso-de-for-y-enumerate-en-python">Uso de <code class="docutils literal notranslate"><span class="pre">for</span></code> y <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> en Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo">Ejemplo</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analisis-frecuencial-de-senales-usando-ventanas">
<h1>Análisis frecuencial de señales usando ventanas<a class="headerlink" href="#analisis-frecuencial-de-senales-usando-ventanas" title="Permalink to this heading">#</a></h1>
<p>Desde el punto de vista computacional, la transformada de Fourier en Tiempo Discreto (DTFT), definida como:</p>
<div class="math notranslate nohighlight">
\[X(\omega)=\sum_{n=-\infty}^{\infty} x(n)e^{-j\omega n}\]</div>
<p>presenta dos problemas:</p>
<ul class="simple">
<li><p>el hecho de que presenta una suma infinita de términos</p></li>
<li><p>en el intervalo fundamental de frecuencias <span class="math notranslate nohighlight">\(-\pi\le\omega &lt;\pi\)</span> hay infinitas frecuencias por lo que no puede computarse la transformada para todas las frecuencias</p></li>
</ul>
<p>Como consecuencia de la primer afirmación cuando se tienen señales de duración infinita
pueden aproximarse por señales de duración finita <span class="math notranslate nohighlight">\(\tilde x\)</span> que se obtienen multiplicando
la señal original <span class="math notranslate nohighlight">\(x(n)\)</span> por una ventana <span class="math notranslate nohighlight">\(w(n)\)</span> de longitud finita <span class="math notranslate nohighlight">\(L\)</span>.</p>
<p>Es decir:</p>
<div class="math notranslate nohighlight">
\[\tilde x(n)=x(n)w(n)\]</div>
<p>y entonces podemos hacer una aproximación como:</p>
<div class="math notranslate nohighlight">
\[X(\omega)\approx \sum_{n=0}^{L-1} \tilde x(n)e^{-j\omega n}\]</div>
<p>y entonces podemos hacer una aproximación como:</p>
<div class="math notranslate nohighlight">
\[X(\omega)\approx \sum_{n=0}^{L-1} \tilde x(n)e^{-j\omega n}\]</div>
<p>El problema de las infinitas frecuencias es fácil de resolver
ya que puede computarse en un número finito de frecuencias equi-espaciadas de la forma:</p>
<div class="math notranslate nohighlight">
\[\omega_k = \frac{2\pi k}{N}, \quad k= 0, 1, \ldots, N-1\]</div>
<ul class="simple">
<li><p>Si la señal es analógica, la misma se pasa usualmente a través de un <strong>filtro antialiasing</strong>,
y luego se muestrea con una frecuencia <span class="math notranslate nohighlight">\(F_s\le 2B\)</span>,
donde <span class="math notranslate nohighlight">\(B\)</span> es el ancho de banda de la señal filtra.</p></li>
</ul>
<ul class="simple">
<li><p>La máxima frecuencia en la señal muestreada es <span class="math notranslate nohighlight">\(F_s/2\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>Luego, por las razones de implementación práctica mencionadas
se limita la duración de la señal a un intervalo de tiempo <span class="math notranslate nohighlight">\(T_0=LT\)</span>,
donde <span class="math notranslate nohighlight">\(L\)</span> es el número de muestras y <span class="math notranslate nohighlight">\(T=\dfrac{1}{F_s}\)</span> es el periodo de muestreo.</p></li>
</ul>
<p>Veremos que la longitud finita de la ventana usada para truncar
la señal pone límite en la <strong>resolución en frecuencia</strong>,
es decir en la capacidad de distinguir entre dos componentes de frecuencia
que están separadas  menos de <span class="math notranslate nohighlight">\(\dfrac{1}{T_0}=\dfrac{1}{L.T}\)</span> en frecuencia.</p>
<p><strong>Sea <span class="math notranslate nohighlight">\(x(n)\)</span> la señal a analizar.</strong></p>
<p>Limitar la duración de la señal a <span class="math notranslate nohighlight">\(L\)</span> muestras en el intervalo <span class="math notranslate nohighlight">\(0\leq n \leq L-1\)</span>
es equivalente a multiplicar a <span class="math notranslate nohighlight">\(x(n)\)</span> por una función ventana rectangular <span class="math notranslate nohighlight">\(w(n)\)</span> de longitud <span class="math notranslate nohighlight">\(L\)</span>,
es decir:</p>
<div class="math notranslate nohighlight">
\[\tilde x(n)=x(n)w(n)\]</div>
<p>donde:</p>
<div class="math notranslate nohighlight">
\[\begin{split}w(n)=\left\{ 
 \begin{array}{l}
   1\quad 0\leq n \leq L-1\\
   0\quad \text{coc} 
   \end{array}
   \right.
\end{split}\]</div>
<p>El espectro de la señal <span class="math notranslate nohighlight">\(x(n)\)</span> estará entonces relacionado con el espectro de <span class="math notranslate nohighlight">\(\tilde x(n)\)</span> a través de la convolución (periódica)</p>
<div class="math notranslate nohighlight">
\[\tilde X(n)=\frac{1}{2\pi}\int_{\infty}^{\infty} X(\lambda)W(\omega-\lambda)d\lambda\]</div>
<p>Es claro entonces que la forma del espectro de la ventana <span class="math notranslate nohighlight">\(W(\omega)\)</span> afectará al espectro <span class="math notranslate nohighlight">\(\tilde X(\omega)\)</span> con el cuál se quiere
aproximar a <span class="math notranslate nohighlight">\(X(\omega)\)</span>.</p>
<p>Para comprender mejor esto analicemos en primera instancia el caso de la ventana rectangular.
Como ya vimos:</p>
<div class="math notranslate nohighlight">
\[W(\omega)=e^{\frac{-j\omega(L-1)}{2}}\frac{\sin(\omega L/1}{\sin(\omega/2)}\]</div>
<p>Por lo que:</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{align}
|W(\omega)|&amp;=\left\{
  \begin{align}
    L \omega=0&amp;\\ 
    \left|\frac{\sin(\omega L/2)}{\sin(\omega/2)}\right|&amp;\quad\text{coc}
    \end{align}
  \right.\\
\angle W(\omega)&amp;=-\frac{\omega}{2}(L-1)+\angle\frac{\sin(\omega L/2)}{\sin(\omega/2)}
\end{align}
\end{split}\]</div>
<p>De la convolución anterior vemos que para tener:</p>
<div class="math notranslate nohighlight">
\[\tilde X(\omega)=X(\omega)\]</div>
<p>deberá ser <span class="math notranslate nohighlight">\(W(\omega)=2\pi\delta(\omega)\)</span>, para lo cuál <span class="math notranslate nohighlight">\(L=\infty\)</span>, o sea:</p>
<div class="math notranslate nohighlight">
\[\tilde x(n)=x(n)\]</div>
<p>En efecto, calculemos el espectro de una ventana rectangular de longitud infinita, es decir:</p>
<div class="math notranslate nohighlight">
\[w(n)=1, \qquad \forall n\]</div>
<p>Podemos ver que la señal es periódica con período <span class="math notranslate nohighlight">\(N=1\)</span>.
Los coeficientes de su serie de Fourier en TD vienen dados por:</p>
<div class="math notranslate nohighlight">
\[c_l=\frac{1}{N}\sum_{n=0}^{N-1}w(n)e^{-j 2\pi ln/N}, \quad \text{con}\quad l=0,1,2,\ldots, N-1\]</div>
<p>Que en esta caso resulta en un único coeficiente:</p>
<div class="math notranslate nohighlight">
\[c_0=\sum_{n=0}^{0} w(n)e^{-j2\pi 0n}=1\]</div>
<p>Recordemos que la transformada de Fourier en TD de una señal periódica viene dada por</p>
<div class="math notranslate nohighlight">
\[ W(w)=2\pi \sum_{k=0}^{N-1}c_k\sum_{l=-\infty}^{\infty}\delta\left(\omega-\frac{2\pi k}{N}-2\pi l\right) \]</div>
<p>Para el caso del ejemplo resulta entonces</p>
<div class="math notranslate nohighlight">
\[W(w)=2\pi\sum_{l=-\infty}^{\infty} \delta (\omega - 2\pi l)\]</div>
<p>El hecho de que <span class="math notranslate nohighlight">\(W(\omega)\)</span> no sea <span class="math notranslate nohighlight">\(\delta(\omega)\)</span> trae varios problemas. Consideremos una secuencia <span class="math notranslate nohighlight">\(x(n)\)</span> que consiste de una sola
sinusoide:</p>
<div class="math notranslate nohighlight">
\[x(n)= \cos\omega_0n\]</div>
<p>El espectro de la señal de duración finita <span class="math notranslate nohighlight">\(\tilde x(n)\)</span> viene dado por (Teorema de Modulación):</p>
<div class="math notranslate nohighlight">
\[\tilde X(n)=\frac{1}{2}\left[W(\omega-\omega_0)W(\omega+\omega_0)\right]\]</div>
<p>Como se ve en la figura anterior el espectro <span class="math notranslate nohighlight">\(\tilde X(\omega)\)</span> de no está
localizado en una única frecuencia, sino que está distribuido en todo el rango de frecuencias.</p>
<p>Este fenómeno (debido a la ventana) se denomina <strong>leakage</strong>.
El ancho del lóbulo principal en el espectro de la ventana determina la resolución en frecuencia.</p>
<div class="math notranslate nohighlight">
\[x(n)=\cos(\omega_1n)+\cos(\omega_2n)\]</div>
<p>El espectro de la señal truncada a <span class="math notranslate nohighlight">\(L\)</span> muestras en el rango <span class="math notranslate nohighlight">\(0\leq n \leq L-1\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\tilde X(\omega) = \frac{1}{2}\left[W(\omega-\omega_1)+W(\omega+\omega_1)+W(\omega-\omega_2)+W(\omega+\omega_2)\right]\]</div>
<div class="math notranslate nohighlight">
\[x(n)=\cos(\omega_1n)+\cos(\omega_2n)\]</div>
<p>El espectro de la señal truncada a <span class="math notranslate nohighlight">\(L\)</span> muestras en el rango <span class="math notranslate nohighlight">\(0\leq n \leq L-1\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\tilde X(\omega) = \frac{1}{2}\left[W(\omega-\omega_1)+W(\omega+\omega_1)+W(\omega-\omega_2)+W(\omega+\omega_2)\right]\]</div>
<p>Como el espectro de <span class="math notranslate nohighlight">\(W(\omega)\)</span> tiene el primer cruce por cero en:</p>
<div class="math notranslate nohighlight">
\[\omega=\frac{2\pi}{L}\]</div>
<p>Entonces si <span class="math notranslate nohighlight">\(|\omega_1-\omega_2| &lt; 4\pi/L\)</span>, las dos funciones <span class="math notranslate nohighlight">\(W(\omega-\omega_1)\)</span>
y <span class="math notranslate nohighlight">\(W(\omega-\omega_2)\)</span> se superponen y en consecuencia las dos líneas espectrales de
<span class="math notranslate nohighlight">\(x(n)\)</span> no se distinguen.</p>
<p>Sólo si <span class="math notranslate nohighlight">\(|\omega_1-\omega_2|\geq 4\pi/L\)</span>
(donde <span class="math notranslate nohighlight">\(4\pi/L\)</span> es el ancho del lóbulo principal del espectro de la ventana rectangular)
se verán dos lóbulos separados en el espectro <span class="math notranslate nohighlight">\(\tilde X(w)\)</span>.</p>
<p>Es decir, <strong>la capacidad para distinguir líneas espectrales de diferente</strong>
<strong>frecuencia está limitada por el ancho del lóbulo principal de la ventana</strong>.</p>
<p>Consideremos ahora el <strong>ejemplo</strong> de una señal con tres componentes sinusoidales, dos de ellas con frecuencias muy próximas.</p>
<div class="math notranslate nohighlight">
\[x(n)= \cos(0.2\omega n) + \cos(0.22\omega n) + \cos(0.6\omega n)\]</div>
<p>El Espectro de Módulo usando ventana rectangular, para <span class="math notranslate nohighlight">\(L = 25\)</span>, y <span class="math notranslate nohighlight">\(L = 50\)</span> resulta</p>
<p>De donde puede observarse que no se distinguen las líneas espectrales
correspondientes a las frecuencias próximas <span class="math notranslate nohighlight">\(\omega_1\)</span> y <span class="math notranslate nohighlight">\(\omega_2\)</span>.</p>
<p>Si consideramos en cambio <span class="math notranslate nohighlight">\(L = 100\)</span>, las líneas espectrales son distinguibles.</p>
<p>Para solucionar el problema del <em>leakage</em> se propone utilizar una ventana que tenga un espectro que se asemeje en mayor medida al impulso.
Por ejemplo si consideramos la <strong>ventana de Hann</strong> (<code class="docutils literal notranslate"><span class="pre">hanning</span></code>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
w(n)=\left\{
  \begin{array}{ll}
   \dfrac{1}{2}\left(1-\cos\left(\dfrac{2\pi n}{L}\right)\right)&amp;0\geq n \geq L-1\\
   0 &amp; \text{c.o.c.}
   \end{array}
  \right.
\end{split}\]</div>
<p>El espectro de módulo tiene las siguientes características:</p>
<ul class="simple">
<li><p>Lóbulos laterales significativamente más pequeños que la ventana rectangular (menor leakage)</p></li>
<li><p>Lóbulo principal aproximadamente 2 veces más ancho que la ventana rectangular (peor resolución)</p></li>
</ul>
<p>Considerando el ejemplo con las tres componentes senoidales, pero usando una ventana Hann con los mismos valores de <span class="math notranslate nohighlight">\(L\)</span>jjj, los espectros resultan:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
w(n)=\left\{
  \begin{array}{ll}
   \dfrac{1}{2}\left(1-\cos\left(\dfrac{2\pi n}{L}\right)\right)&amp;0\geq n \geq L-1\\
   0 &amp; \text{c.o.c.}
   \end{array}
  \right.
\end{split}\]</div>
<p>PONER FIGURAS DE LA VENTANA DE HANN</p>
<p>Otra ventana, con un espectro similar al de la ventana de Hann es la <strong>ventana de Hamming</strong> (<code class="docutils literal notranslate"><span class="pre">hamming</span></code>), que se
muestra a continuación:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
w(n)=\left\{
  \begin{array}{ll}
   \left(0.54-0.46\cos\left(\dfrac{2\pi n}{L}\right)\right)&amp;0\geq n \geq L-1\\
   0 &amp; \text{c.o.c.}
   \end{array}
  \right.
\end{split}\]</div>
<p>PONER FIGURAS DE LA VENTANA DE HAMMING</p>
<section id="computo-de-la-transformada-de-fourier-en-tiempo-discreto-para-senales-de-longitud-finita">
<h2>Cómputo de la Transformada de Fourier en Tiempo Discreto para señales de longitud finita<a class="headerlink" href="#computo-de-la-transformada-de-fourier-en-tiempo-discreto-para-senales-de-longitud-finita" title="Permalink to this heading">#</a></h2>
<p>Sea <span class="math notranslate nohighlight">\(x(n)\)</span> una señal causal de longitud finita <span class="math notranslate nohighlight">\(L\)</span>. Su DTFT viene dada por:</p>
<div class="math notranslate nohighlight">
\[
X(\omega)= \sum_{n=0}^{L-1}x(n)e^{-j\omega n}
\]</div>
<p>Para solucionar el problema de que existen infinitas frecuencias en el intervalo fundamental <span class="math notranslate nohighlight">\(-\pi\le\omega&lt;\pi\)</span>, calcularemos un número finito <span class="math notranslate nohighlight">\(N\)</span> de frecuencias equiespaciadas de la forma</p>
<div class="math notranslate nohighlight">
\[\omega_k=\frac{2\pi k}{N}, \quad k=0,1,2,\ldots, N-1\]</div>
<p>Resulta entonces:</p>
<div class="math notranslate nohighlight">
\[
X(\omega)= \sum_{n=0}^{L-1}x(n)e^{-j\frac{2\pi k\omega n}{N}},\quad k=0,1,2,\ldots, N-1
\]</div>
<p>que puede escribirse como:</p>
<div class="math notranslate nohighlight">
\[X(\omega_0)=x(0)e^{-j\frac{2\pi\times 0\times 0}{N}}+x(1)e^{-j\frac{2\pi\times 0\times 1}{N}}+\cdots+x(N)e^{-j\frac{2\pi\times 0\times (L-1)}{N}}\]</div>
<div class="math notranslate nohighlight">
\[x(\omega_1)=x(0)e^{-j\frac{2\pi\times 1\times 0}{n}}+x(1)e^{-j\frac{2\pi\times 1\times 1}{n}}+\cdots+x(n)e^{-j\frac{2\pi\times 1\times (l-1)}{n}}\]</div>
<div class="math notranslate nohighlight">
\[\vdots\]</div>
<div class="math notranslate nohighlight">
\[x(\omega_{N-1})=x(0)e^{-j\frac{2\pi\times (N-1)\times 0}{n}}+x(1)e^{-j\frac{2\pi\times (N-1)\times 1}{n}}+\cdots+x(n)e^{-j\frac{2\pi\times (N-1)\times (l-1)}{n}}\]</div>
<p>En forma matricial sería:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
X(\omega_0)\\
X(\omega_1)\\
\vdots\\
X(\omega_{N-1})
\end{bmatrix}=
\begin{bmatrix}
e^{-j\frac{2\pi\times 0\times 0}{N}} &amp; e^{-j\frac{2\pi\times 0\times 1}{N}} &amp; \cdots &amp; e^{-j\frac{2\pi\times (N-1)\times (L-1)}{N}}\\
e^{-j\frac{2\pi\times 1\times 0}{N}} &amp; e^{-j\frac{2\pi\times 1\times 1}{N}} &amp; \cdots &amp; e^{-j\frac{2\pi\times (N-1)\times (L-1)}{N}}\\
\vdots &amp; \vdots &amp; \cdots &amp; \vdots\\
e^{-j\frac{2\pi\times (N-1)\times 0}{N}} &amp; e^{-j\frac{2\pi\times (N-1)\times 1}{N}} &amp; \cdots &amp; e^{-j\frac{2\pi\times (N-1)\times (L-1)}{N}}\\
\end{bmatrix}
\begin{bmatrix}
x(0)\\
x(1)\\
\vdots\\
x(n)
\end{bmatrix}
\end{split}\]</div>
<p>que es muy facil de implementar con un algoritmo de computación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fftshift</span><span class="p">,</span> <span class="n">fftfreq</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dtft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">L</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">k</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">w</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="o">/</span><span class="n">N</span>
    <span class="n">n</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">L</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">L</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="nd">@n</span><span class="p">)))</span><span class="nd">@x</span><span class="p">,</span> <span class="n">w</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generamos la señal</span>
<span class="n">L</span><span class="o">=</span><span class="mi">10</span>
<span class="n">n</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">L</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">x</span><span class="o">=</span><span class="mf">0.9</span><span class="o">**</span><span class="n">n</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">1024</span>
<span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">dtft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">w1</span><span class="o">=</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;módulo&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;|X($\omega$)|&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;rad/seg&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;módulo&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fftshift</span><span class="p">(</span><span class="n">w1</span><span class="p">),</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>
<span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/da091ed991c7fbeeec874e18be819929e2b1a18025d2a0b5bd9db217640ae33e.png" src="../../_images/da091ed991c7fbeeec874e18be819929e2b1a18025d2a0b5bd9db217640ae33e.png" />
</div>
</div>
</section>
<section id="transformada-ideal">
<h2>Transformada ideal<a class="headerlink" href="#transformada-ideal" title="Permalink to this heading">#</a></h2>
<p>Consideremos ahora la señal de longitud infinita
$<span class="math notranslate nohighlight">\(x_1(n)= (0.9)^n\mu(n)\)</span>$</p>
<p>Podemos pensar que <span class="math notranslate nohighlight">\(x(n)\)</span> en el ejemplo anterior es una versión truncada con una ventana rectangular de longitud <span class="math notranslate nohighlight">\(L\)</span> de la señal de longitud infinita <span class="math notranslate nohighlight">\(x_1(n)\)</span>. Calculemos la DTFT de <span class="math notranslate nohighlight">\(x_1(n)\)</span>.</p>
<p>Resulta</p>
<div class="math notranslate nohighlight">
\[X_1(\omega)=\sum_{n=0}^{\infty}(0.9e^{-j\omega})^n=\frac{1}{1-0.9e^{-j\omega}}\]</div>
<p>Grafiquemos el espectro de módulo de <span class="math notranslate nohighlight">\(x_1(n)\)</span> y de <span class="math notranslate nohighlight">\(x(n)\)</span> para distintos valores de <span class="math notranslate nohighlight">\(L\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">winf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">1024</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X1</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="mf">0.9</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">winf</span><span class="p">))))</span>

<span class="n">L1</span><span class="o">=</span><span class="mi">10</span>
<span class="n">n1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">L1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">xl1</span><span class="o">=</span><span class="mf">0.9</span><span class="o">**</span><span class="n">n1</span>
<span class="n">Xl1</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="n">dtft</span><span class="p">(</span><span class="n">xl1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>

<span class="n">L2</span><span class="o">=</span><span class="mi">20</span>
<span class="n">n2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L2</span><span class="p">,</span> <span class="n">L2</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">L2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">xl2</span><span class="o">=</span><span class="mf">0.9</span><span class="o">**</span><span class="n">n2</span>
<span class="n">Xl2</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="n">dtft</span><span class="p">(</span><span class="n">xl2</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>

<span class="n">L3</span><span class="o">=</span><span class="mi">50</span>
<span class="n">n3</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L3</span><span class="p">,</span> <span class="n">L3</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">L3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">xl3</span><span class="o">=</span><span class="mf">0.9</span><span class="o">**</span><span class="n">n3</span>
<span class="n">Xl3</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="n">dtft</span><span class="p">(</span><span class="n">xl3</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">winf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$L=\infty$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">winf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fftshift</span><span class="p">(</span><span class="n">Xl1</span><span class="p">)),</span>  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$L=10$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">winf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fftshift</span><span class="p">(</span><span class="n">Xl2</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$L=20$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">winf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fftshift</span><span class="p">(</span><span class="n">Xl3</span><span class="p">)),</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$L=50$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;rad/seg&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;módulo&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;|X($\omega$)|&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2681a4fbbae5fe1dc42b9b37728c250d9d9720faf109ad1fe4b42b16b3cd880c.png" src="../../_images/2681a4fbbae5fe1dc42b9b37728c250d9d9720faf109ad1fe4b42b16b3cd880c.png" />
</div>
</div>
</section>
<section id="transformada-discreta-de-fourier">
<h2>Transformada Discreta de Fourier<a class="headerlink" href="#transformada-discreta-de-fourier" title="Permalink to this heading">#</a></h2>
<p>Vimos que la DTFT de una señal causal <span class="math notranslate nohighlight">\(x(n)\)</span>, de longitud finita <span class="math notranslate nohighlight">\(L\)</span>,
calculada en <span class="math notranslate nohighlight">\(N\)</span> frecuencias equi-espaciadas de la forma:</p>
<div class="math notranslate nohighlight">
\[ \omega_k=\frac{2\pi k}{N}, \quad k=1,2,\cdots, N-1\]</div>
<p>viene dada por:</p>
<div class="math notranslate nohighlight">
\[\sum_{n=0}^{L-1}x(n)e^{-j\frac{2\pi kn}{N}}\quad k=1,2,\cdots, N-1\]</div>
<p>Puede pensarse entonces que son muestras del espectro <span class="math notranslate nohighlight">\(X(\omega_k)\)</span> son muestras del espectro <span class="math notranslate nohighlight">\(X(\omega)\)</span> en las frecuencias <span class="math notranslate nohighlight">\(\omega_k\)</span>.</p>
<p>Se define entonces la <strong>Transformada Discreta de Fourier con N puntos de la señal <span class="math notranslate nohighlight">\(x(n)\)</span></strong> como</p>
<div class="math notranslate nohighlight">
\[X(k)\triangleq \sum_{n=0}^{N-1}x(n)e^{-j\frac{2\pi kn}{N}}, \quad k=0,1,2,\cdots, N-1\]</div>
<p>Vemos, comparando las expresiones anteriores, que si la señal es de longitud <span class="math notranslate nohighlight">\(L\leq N\)</span>,
la Transformada Discreta de Fourier con <span class="math notranslate nohighlight">\(N\)</span> puntos puede pensarse como muestras del espectro <span class="math notranslate nohighlight">\(X(\omega)\)</span>
en las frecuencias equi-espaciadas <span class="math notranslate nohighlight">\(\omega_k\)</span>.
Si en cambio no se verifica que <span class="math notranslate nohighlight">\(L\leq N\)</span>, la DFT con <span class="math notranslate nohighlight">\(N\)</span> puntos no puede pensarse como muestras del espectro <span class="math notranslate nohighlight">\(X(\omega)\)</span> en <span class="math notranslate nohighlight">\(\omega_k\)</span>.</p>
<p>No es difícil probar que la DFT con <span class="math notranslate nohighlight">\(N\)</span> puntos <span class="math notranslate nohighlight">\(X(k)\)</span> es periódica con período <span class="math notranslate nohighlight">\(N\)</span>. En efecto:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ll}
X(k+N)=&amp;\sum_{n=0}^{N-1}x(n)e^{-j\frac{2\pi (k+N)n}{N}}\\
&amp;\sum_{n=0}^{N-1}x(n)e^{-j\frac{2\pi kn}{N}}\underbrace{e^{-j\frac{2\pi kN}{N}}}_{=1}\\
&amp;\sum_{n=0}^{N-1}x(n)e^{-j\frac{2\pi kn}{N}}=X(k)\\
\end{array}
\end{split}\]</div>
<p>Teniendo en cuenta que <span class="math notranslate nohighlight">\(X(k)\)</span> es periódica con período <span class="math notranslate nohighlight">\(N\)</span>, y
observando la expresión de <span class="math notranslate nohighlight">\(X(k)\)</span>, notamos que esa
expresión es la Serie de Fourier discreta de <span class="math notranslate nohighlight">\(X(k)\)</span>, por lo
que podemos concluir que:</p>
<div class="math notranslate nohighlight">
\[X(k)\triangleq\sum_{n=0}^{N-1}x(n)e^{-j\frac{2\pi kn}{N}}\implies x(n)=c_{-n}\]</div>
<p>siendo <span class="math notranslate nohighlight">\(c_{-n}\)</span> los coeficientes de Fourier.</p>
<p>Finalmente, teniendo en cuenta la expresión de los coeficientes de
Fourier:</p>
<div class="math notranslate nohighlight">
\[c_n=\frac{1}{N}\sum_{n=0}^{N-1}X(k)e^{-j\frac{2\pi kn}{N}}\quad n=0,1,\cdots,N-1\]</div>
<p>podemos concluir que</p>
<div class="math notranslate nohighlight">
\[x(n)\triangleq \sum_{k=0}^{N-1}X(k)e^{j\frac{2\pi kn}{N}}\quad n=0,1,\cdots,N-1\]</div>
<p>Es decir que, para el caso en que <span class="math notranslate nohighlight">\(L\leq N\)</span>, la señal <span class="math notranslate nohighlight">\(x(n)\)</span> puede
recuperarse a partir de las muestras <span class="math notranslate nohighlight">\(X(k)\)</span> según la expresión anterior,
que se denomina <strong>Transformada Discreta de Fourier
Inversa (IDFT)</strong>.</p>
</section>
<section id="transformada-rapida-de-fourier-fft-fast-fourier-transform">
<h2>Transformada Rápida de Fourier (FFT: Fast Fourier Transform)<a class="headerlink" href="#transformada-rapida-de-fourier-fft-fast-fourier-transform" title="Permalink to this heading">#</a></h2>
<p>El algoritmo desarrollado para el cálculo directo
de la DTFT no es eficiente desde el punto de vista computacional
ya que requiere del orden de <span class="math notranslate nohighlight">\(N^2\)</span> multiplicaciones
complejas. Por ejemplo, si se calculan 1024 frecuencias, se
requerirían 1048576 multiplicaciones.</p>
<p>Si se tienen en cuenta algunas propiedades de simetría de
los coeficientes:</p>
<div class="math notranslate nohighlight">
\[e^{-j\frac{2\pi kn}{N}}\]</div>
<p>se pueden desarrollar algoritmos más rápidos.</p>
<p>En particular, uno de los más difundidos es el algoritmo
denominado <strong>Transformada Rápida de Fourier (FFT:
Fast Fourier Transform)</strong> que requiere del orden de</p>
<div class="math notranslate nohighlight">
\[\frac{N}{2}\log_2 N\]</div>
<p>multiplicaciones complejas, cuando <span class="math notranslate nohighlight">\(N\)</span> es potencia entera de
2. Para el ejemplo de <span class="math notranslate nohighlight">\(N = 1024\)</span>, resultan 5120 multiplicaciones,
lo que representa un factor de mejora en la velocidad de 204.8.</p>
<p>En Python, este algoritmo está implementado tanto en los paquetes <code class="docutils literal notranslate"><span class="pre">scipy</span></code> y <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.
La forma de uso es la misma para las dos implementaciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># podemos importarla de numpy</span>
<span class="kn">from</span> <span class="nn">numpy.fft</span> <span class="kn">import</span> <span class="n">fft</span> 
<span class="c1"># o podemos importarla de scipy</span>
<span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fft</span>
</pre></div>
</div>
</div>
</div>
<p>La función <code class="docutils literal notranslate"><span class="pre">fft</span></code> se utiliza se utiliza de la siguiente manera:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fft</span>
<span class="n">X</span><span class="o">=</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<p>donde:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> son las muestras de la señal</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X</span></code> son los valores de la transformada</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> número de frecuencias donde se calcula la transformada, que debe ser de la forma <span class="math notranslate nohighlight">\(N=2^m\)</span> para que el algoritmo sea
rápido.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">loadmat</span>
<span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftshift</span><span class="p">,</span> <span class="n">fftfreq</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># importa las variables que estan en el .mat en un diccionario data</span>
<span class="n">data</span><span class="o">=</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;TP3Prob4_2022.mat&#39;</span><span class="p">)</span> 
<span class="c1"># extraigo las variables del diccionario</span>
<span class="n">t</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> 
<span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="n">Fs</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Fs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Fs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">File ~/miniforge3/envs/dsp/lib/python3.12/site-packages/scipy/io/matlab/_mio.py:39,</span> in <span class="ni">_open_file</span><span class="nt">(file_like, appendmat, mode)</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">39</span>     <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_like</span><span class="p">,</span> <span class="n">mode</span><span class="p">),</span> <span class="kc">True</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="c1"># Probably &quot;not found&quot;</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;TP3Prob4_2022.mat&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># importa las variables que estan en el .mat en un diccionario data</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">data</span><span class="o">=</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;TP3Prob4_2022.mat&#39;</span><span class="p">)</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># extraigo las variables del diccionario</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">t</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> 

<span class="nn">File ~/miniforge3/envs/dsp/lib/python3.12/site-packages/scipy/io/matlab/_mio.py:225,</span> in <span class="ni">loadmat</span><span class="nt">(file_name, mdict, appendmat, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">88</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">89</span><span class="sd"> Load MATLAB file.</span>
<span class="g g-Whitespace">     </span><span class="mi">90</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span><span class="sd">     3.14159265+3.14159265j])</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span> <span class="n">variable_names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;variable_names&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">225</span> <span class="k">with</span> <span class="n">_open_file_context</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">appendmat</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">226</span>     <span class="n">MR</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mat_reader_factory</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span>     <span class="n">matfile_dict</span> <span class="o">=</span> <span class="n">MR</span><span class="o">.</span><span class="n">get_variables</span><span class="p">(</span><span class="n">variable_names</span><span class="p">)</span>

<span class="nn">File ~/miniforge3/envs/dsp/lib/python3.12/contextlib.py:137,</span> in <span class="ni">_GeneratorContextManager.__enter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">137</span>     <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span> <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span>     <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;generator didn&#39;t yield&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>

<span class="nn">File ~/miniforge3/envs/dsp/lib/python3.12/site-packages/scipy/io/matlab/_mio.py:17,</span> in <span class="ni">_open_file_context</span><span class="nt">(file_like, appendmat, mode)</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="nd">@contextmanager</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="k">def</span> <span class="nf">_open_file_context</span><span class="p">(</span><span class="n">file_like</span><span class="p">,</span> <span class="n">appendmat</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rb&#39;</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">17</span>     <span class="n">f</span><span class="p">,</span> <span class="n">opened</span> <span class="o">=</span> <span class="n">_open_file</span><span class="p">(</span><span class="n">file_like</span><span class="p">,</span> <span class="n">appendmat</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span>     <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span>         <span class="k">yield</span> <span class="n">f</span>

<span class="nn">File ~/miniforge3/envs/dsp/lib/python3.12/site-packages/scipy/io/matlab/_mio.py:45,</span> in <span class="ni">_open_file</span><span class="nt">(file_like, appendmat, mode)</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span>     <span class="k">if</span> <span class="n">appendmat</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">file_like</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.mat&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span>         <span class="n">file_like</span> <span class="o">+=</span> <span class="s1">&#39;.mat&#39;</span>
<span class="ne">---&gt; </span><span class="mi">45</span>     <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_like</span><span class="p">,</span> <span class="n">mode</span><span class="p">),</span> <span class="kc">True</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span>     <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span>         <span class="s1">&#39;Reader needs file name or open file-like object&#39;</span>
<span class="g g-Whitespace">     </span><span class="mi">49</span>     <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;TP3Prob4_2022.mat&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
<span class="n">N</span><span class="o">=</span><span class="mi">4096</span><span class="o">*</span><span class="mi">8</span><span class="p">;</span> <span class="c1"># notar que N &gt; L</span>
<span class="n">Y</span><span class="o">=</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
<span class="c1">#F=[-Fs/2:Fs/N:Fs/2-Fs/N]&#39;;</span>
<span class="n">F</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">F</span><span class="o">=</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">absY</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="n">picomax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">absY</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">picomax</span><span class="o">/</span><span class="n">L</span><span class="p">;</span> <span class="c1"># amplitud de la senoide</span>
<span class="n">ind</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">absY</span><span class="o">==</span><span class="n">picomax</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fsen</span><span class="o">=</span><span class="n">F</span><span class="p">[</span><span class="n">ind</span><span class="p">];</span> <span class="c1"># frecuencia de la senoide</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fftshift</span><span class="p">(</span><span class="n">F</span><span class="p">),</span><span class="n">fftshift</span><span class="p">(</span><span class="n">absY</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frecuencia del seno: </span><span class="si">{</span><span class="n">Fsen</span><span class="si">}</span><span class="s2">, amplitud del seno: </span><span class="si">{</span><span class="n">A</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtrado en el dominio FFT</span>
<span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">ifft</span>
<span class="n">filtro</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">F</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">199</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">201</span><span class="p">:</span>
        <span class="n">filtro</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Yfiltrada</span><span class="o">=</span><span class="n">Y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">filtro</span>
<span class="n">yfiltrada</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ifft</span><span class="p">(</span><span class="n">Yfiltrada</span><span class="p">))</span>
<span class="n">yfiltrada</span><span class="o">=</span><span class="n">yfiltrada</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">L</span><span class="p">]</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fftshift</span><span class="p">(</span><span class="n">F</span><span class="p">),</span><span class="nb">abs</span><span class="p">(</span><span class="n">fftshift</span><span class="p">(</span><span class="n">Yfiltrada</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fftshift</span><span class="p">(</span><span class="n">F</span><span class="p">),</span><span class="mi">5000</span><span class="o">*</span><span class="n">fftshift</span><span class="p">(</span><span class="n">filtro</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yfiltrada</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="uso-de-for-y-enumerate-en-python">
<h2>Uso de <code class="docutils literal notranslate"><span class="pre">for</span></code> y <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> en Python<a class="headerlink" href="#uso-de-for-y-enumerate-en-python" title="Permalink to this heading">#</a></h2>
<p>El <code class="docutils literal notranslate"><span class="pre">for</span></code> en Python se puede utilizar en objetos sobre los cuales se puede <em>iterar</em>.
Estos objetos se dicen que son <em>iterables</em>.</p>
<p>Cuando se itera utilizando un <em>for</em> en Python, en cada iteración se va obteniendo
cada uno de los elemento del objeto sobre el cual se está iterando.</p>
<p>En el caso del diseño del filtro se quieren eliminar todas
las componentes de frecuencias que no se corresponden con la del seno que se quiere recuperar.
Es decir, el filtro deberá ser un vector de ceros,
donde solo sean 1 las componentes que se correspondan con las frecuencias
en torno a la frecuencia de la senoide (<span class="math notranslate nohighlight">\(\approx 200\)</span> Hz).
En nuestro caso decidimos hacer 1 todas las componentes de frecuencia que son mayores a 199
y menores a 201, tanto positivas como negativas.</p>
<p>Para hacerlo utilizando el bucle <code class="docutils literal notranslate"><span class="pre">for</span></code> recorro el vector de frecuencias <span class="math notranslate nohighlight">\(F\)</span> y
obtengo el indice en <code class="docutils literal notranslate"><span class="pre">i</span></code> y el valor de la frecuencia el <code class="docutils literal notranslate"><span class="pre">val</span></code> mediante el uso
de la función <code class="docutils literal notranslate"><span class="pre">enumerate</span></code>. Si el valor de la frecuencia está entre los seleccionados
se utiliza el indice <code class="docutils literal notranslate"><span class="pre">i</span></code> para hacer 1 la componente del filtro que se corresponde con la
frecuencia <code class="docutils literal notranslate"><span class="pre">val</span></code>.</p>
<p>El índice <code class="docutils literal notranslate"><span class="pre">i</span></code> lo utilizo para hacer 1 las componentes del filtro en las frecuencias de interés.</p>
<section id="ejemplo">
<h3>Ejemplo<a class="headerlink" href="#ejemplo" title="Permalink to this heading">#</a></h3>
<p>Supongamos que que queremos aplicarle una función a cada elemento de un <code class="docutils literal notranslate"><span class="pre">array</span></code> y guardarlo en otro array de igual dimensión y poder graficar los valores del primero respecto del segundo.</p>
<p>Para esto el algoritmo que planteamos podría ser:</p>
<ul class="simple">
<li><p>defino la operación que le vamos a aplicar a cada uno de los elementos</p></li>
<li><p>genero un <code class="docutils literal notranslate"><span class="pre">array</span></code> con los valores que le voy a aplicar la función</p></li>
<li><p>aloco un <code class="docutils literal notranslate"><span class="pre">array</span></code> vacio de mismo tamaño que que anterior</p></li>
<li><p>recorro el primer <code class="docutils literal notranslate"><span class="pre">array</span></code> y guardo cada uno de los resultados en el segundo usando el mismo indice para ambos</p></li>
<li><p>realizo la figura</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">operacion_arbitraria</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">num</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span>


<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1001</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">operacion_arbitraria</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./recursos/nuevo_material"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenido
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computo-de-la-transformada-de-fourier-en-tiempo-discreto-para-senales-de-longitud-finita">Cómputo de la Transformada de Fourier en Tiempo Discreto para señales de longitud finita</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformada-ideal">Transformada ideal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformada-discreta-de-fourier">Transformada Discreta de Fourier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformada-rapida-de-fourier-fft-fast-fourier-transform">Transformada Rápida de Fourier (FFT: Fast Fourier Transform)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#uso-de-for-y-enumerate-en-python">Uso de <code class="docutils literal notranslate"><span class="pre">for</span></code> y <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> en Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo">Ejemplo</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Por Somebody
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>
{"version":1,"kind":"Notebook","sha256":"5accbb8d0338a2d279c81936c4355caff53e76a7bc3cd9834e10bda978c9e819","slug":"recursos.nuevo-material.welch-teoria","location":"/recursos/nuevo_material/welch_teoria.md","dependencies":[],"frontmatter":{"title":"Estimación de la densidad espectral de potencia: método de Welch","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"jupytext":{"formats":"ipynb,md:myst","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.16.7"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Somebody","family":"Somebody"},"name":"Somebody","id":"contributors-myst-generated-uid-0"}],"copyright":"2025","exports":[{"format":"md","filename":"welch_teoria.md","url":"/build/welch_teoria-c22de9f3282e0a8a3faf16daa0db3944.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Periodograma estándar: Relación entre N y varianza","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"QuuOqChJTD"}],"identifier":"periodograma-est-ndar-relaci-n-entre-n-y-varianza","label":"Periodograma estándar: Relación entre N y varianza","html_id":"periodograma-est-ndar-relaci-n-entre-n-y-varianza","implicit":true,"key":"PI35PHuT3y"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"El periodograma se define como:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"vMR7Lvk78b"}],"key":"VJd1IMS3Vn"},{"type":"math","value":"\\hat P(f)= \\frac{1}{N} \\left| \\sum_{n=0}^{N−1}x[n]e^{−j2\\pi fn}\\right|^2","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>P</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msup><mrow><mo fence=\"true\">∣</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>x</mi><mo stretchy=\"false\">[</mo><mi>n</mi><mo stretchy=\"false\">]</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>j</mi><mn>2</mn><mi>π</mi><mi>f</mi><mi>n</mi></mrow></msup><mo fence=\"true\">∣</mo></mrow><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\hat P(f)= \\frac{1}{N} \\left| \\sum_{n=0}^{N−1}x[n]e^{−j2\\pi fn}\\right|^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1968em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9468em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.2995em;vertical-align:-1.2671em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.762em;\"><span style=\"top:-2.566em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-3.164em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span style=\"height:1.816em;width:0.3333em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.3333em' height='1.816em' style='width:0.3333em' viewBox='0 0 333.33000000000004 1816' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V1816 H145z M145 0 H188 V1816 H145z'/></svg></span></span><span style=\"top:-4.972em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.25em;\"><span></span></span></span></span></span></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8829em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2671em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">]</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.762em;\"><span style=\"top:-2.566em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-3.164em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span style=\"height:1.816em;width:0.3333em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.3333em' height='1.816em' style='width:0.3333em' viewBox='0 0 333.33000000000004 1816' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V1816 H145z M145 0 H188 V1816 H145z'/></svg></span></span><span style=\"top:-4.972em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.25em;\"><span></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0323em;\"><span style=\"top:-4.2812em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"daJ8I2JBhq"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"donde ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"qL5AnPPJxs"},{"type":"inlineMath","value":"N","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"lY3NZOwNvg"},{"type":"text","value":" es el número de muestras.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Cs2Hzf8Q3F"}],"key":"naaozoWlvD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Teóricamente, la varianza del periodograma no disminuye al aumentar ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"i057rNf9Vj"},{"type":"inlineMath","value":"N","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"qIXHygCScF"},{"type":"text","value":".","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"sKVfgzidSY"}],"key":"sJ5UvVD7V5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":28,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Esto se debe a que el periodograma es un ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"zfVXELovdQ"},{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"estimador inconsistente","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"ANltx8u9K7"}],"key":"rlxKcDuNFi"},{"type":"text","value":": su varianza no converge a cero incluso con ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"M7VDuTd2KV"},{"type":"inlineMath","value":"N\\rightarrow\\infty","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">N\\rightarrow\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"aHT3wi2afq"},{"type":"text","value":".","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"PbRO7bduOx"}],"key":"d69zjzfW7N"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Aunque el espectro se ve “más suave” porque la resolución frecuencial (","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"veYqpLPB29"},{"type":"inlineMath","value":"\\Delta f=\\frac{f_s}{N}","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>f</mi><mo>=</mo><mfrac><msub><mi>f</mi><mi>s</mi></msub><mi>N</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\Delta f=\\frac{f_s}{N}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2772em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"YCGNQDnIMb"},{"type":"text","value":") mejora, la ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"gke1Ef481R"},{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"variabilidad estadística","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"tkD9k36tZS"}],"key":"NVwNtVCwbI"},{"type":"text","value":" entre frecuencias cercanas sigue siendo alta.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"lzGFcuCRc2"}],"key":"p8vYHtZ7E2"}],"key":"tVqGv7HSc6"}],"key":"S4nZz0S2Q8"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"En la práctica, al aumentar ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"gzWroYXED4"},{"type":"inlineMath","value":"N","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"JS1yYDjpk1"},{"type":"text","value":":","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"bRzoAIQXpE"}],"key":"UzhnzSS2G3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":32,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Los picos espectrales se vuelven más estrechos (mejor resolución).","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"xstNOeNMmX"}],"key":"FiaOjVLlzu"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Pero el “ruido” alrededor de los picos sigue teniendo la misma amplitud relativa.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"e5jYbmruqs"}],"key":"nPi8QX25sw"}],"key":"GSeFvILYin"}],"key":"nWfNDXpmLK"}],"key":"NckptykVqa"}],"key":"BD72qCAPXm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nimport scipy as sc\nfrom scipy.signal import welch, periodogram","key":"NvSh7xdAEE"},{"type":"output","id":"MGHAyU83h-sERIMUZq8bT","data":[],"key":"E2FHlQfLqk"}],"data":{},"key":"fZcXvuWjAV"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Ejemplo en Python","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"rQlVA2h5Aq"}],"identifier":"ejemplo-en-python","label":"Ejemplo en Python","html_id":"ejemplo-en-python","implicit":true,"key":"U4EFRuP0om"}],"key":"sJfttOnPnt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fs = 1000\nt_short = np.arange(0, 1, 1/fs)       # 1 segundo (N=1000)\nt_long = np.arange(0, 10, 1/fs)        # 10 segundos (N=10000)\n\n# Señal: senoide + ruido\nx_short = 0.2*np.sin(2 * np.pi * 50 * t_short) + 0.5 * np.random.randn(len(t_short))\nx_long = 0.2*np.sin(2 * np.pi * 50 * t_long) + 0.5 * np.random.randn(len(t_long))\n\n# Periodogramas\nf_short, pxx_short = periodogram(x_short, fs=fs)\nf_long, pxx_long = periodogram(x_long, fs=fs)\n\n# Gráficos\nplt.figure(figsize=(12, 6))\nplt.plot(f_short, 10 * np.log10(pxx_short), label='N=1000 (alta varianza)')\nplt.plot(f_long, 10 * np.log10(pxx_long), ':',\n         label='N=10000 (misma varianza, mejor resolución)')\nplt.xlabel('Frecuencia (Hz)')\nplt.ylabel('PSD (dB/Hz)')\nplt.legend()\nplt.grid(True)\nplt.show()","key":"biX0JEIODQ"},{"type":"output","id":"EJ4THtXyMMEyoQWNGTLHq","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ebe64199dc15427335925da2a0b3a2d1","path":"/build/ebe64199dc15427335925da2a0b3a2d1.png"}}}],"key":"gOD7CFlg4E"}],"data":{},"key":"ONhjMPzcYQ"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"Método de Welch: Reducción efectiva de varianza","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"Lbg7iafcPS"}],"identifier":"m-todo-de-welch-reducci-n-efectiva-de-varianza","label":"Método de Welch: Reducción efectiva de varianza","html_id":"m-todo-de-welch-reducci-n-efectiva-de-varianza","implicit":true,"key":"dnoJG4huyN"},{"type":"paragraph","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"Welch logra reducir la varianza mediante:","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"X6dhHXmVM6"}],"key":"JXyfCSJPUA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":73,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"strong","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"División en segmentos","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"ogkIUl7Cb7"}],"key":"FyTc9bmZeu"},{"type":"text","value":": La señal de ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"GxKZIIIz1m"},{"type":"inlineMath","value":"N","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"h4zSka9F8N"},{"type":"text","value":" muestras se divide en ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"OsF5IW3QZM"},{"type":"inlineMath","value":"K","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>","key":"IJfsiVcqmh"},{"type":"text","value":" segmentos de longitud ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"fyxKXXqFp4"},{"type":"inlineMath","value":"L","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"XIhHV5bDUV"},{"type":"text","value":" (ej. ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"VSkmUGKWMk"},{"type":"inlineMath","value":"L=256","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo>=</mo><mn>256</mn></mrow><annotation encoding=\"application/x-tex\">L=256</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">256</span></span></span></span>","key":"GKEMOptjSP"},{"type":"text","value":").","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"T5L0Zddlck"}],"key":"XNXylfK8dE"},{"type":"listItem","spread":true,"position":{"start":{"line":74,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"strong","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Promediado","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"riQ1ZaxJmo"}],"key":"bF3N6iEfjC"},{"type":"text","value":": Cada segmento tiene su propio periodograma, y el resultado final es el promedio de todos.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"fU8u2N6GVK"}],"key":"PQBFLaTcZw"}],"key":"AY0156WA3V"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"La varianza disminuye aproximadamente como:","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"nKO44VTtoA"}],"key":"lMo6o2omQJ"},{"type":"math","value":"VarWelch\\approx\\frac{Var_{Periodograma}}{K}","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mi>W</mi><mi>e</mi><mi>l</mi><mi>c</mi><mi>h</mi><mo>≈</mo><mfrac><mrow><mi>V</mi><mi>a</mi><msub><mi>r</mi><mrow><mi>P</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>d</mi><mi>o</mi><mi>g</mi><mi>r</mi><mi>a</mi><mi>m</mi><mi>a</mi></mrow></msub></mrow><mi>K</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">VarWelch\\approx\\frac{Var_{Periodograma}}{K}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">Va</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0463em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Va</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">ama</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"2","key":"iOoq7pGS2p"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"donde ","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"e9t9h3RUkE"},{"type":"inlineMath","value":"K","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>","key":"pB03B6scye"},{"type":"text","value":" es la cantidad de segmentos.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"PFu01xJJeI"}],"key":"PxYd3swNxq"}],"key":"mbPtHEtVJL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Welch con N=10000\nf_welch, pxx_welch = welch(x_long, fs=fs, nperseg=1024, noverlap=256)\n\nplt.figure(figsize=(12, 6))\nplt.plot(f_long, 10 * np.log10(pxx_long), label='Periodograma (N=10000)')\nplt.plot(f_welch, 10 * np.log10(pxx_welch), label='Welch (promediado)')\nplt.xlabel('Frecuencia (Hz)')\nplt.legend()\nplt.grid(True)\nplt.show()","key":"hk2axJDJRT"},{"type":"output","id":"DV8MfZrn-un0mtd5CHkkz","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"95fb43501daacd45f2fa9065c526e03f","path":"/build/95fb43501daacd45f2fa9065c526e03f.png"}}}],"key":"k3eYkzD8t9"}],"data":{},"key":"FgXugQsdDE"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"Resultado:","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"KcPoif58DI"}],"key":"Lp5JQWpYYQ"},{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"Welch muestra un fondo mucho más suave porque promedia ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"KpOFU2Mhzv"},{"type":"inlineMath","value":"K\\approx 39","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>≈</mo><mn>39</mn></mrow><annotation encoding=\"application/x-tex\">K\\approx 39</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">39</span></span></span></span>","key":"GYTupnt6WA"},{"type":"text","value":" segmentos (N=10000, L=256, noverlap=128).","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"Jv4HADMp9z"}],"key":"Pe4wmmHm35"}],"key":"q8G0l2pg9J"},{"type":"block","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Independencia de la varianza al aumento de ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"jT3V40Z1mw"},{"type":"inlineMath","value":"N","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"CwvbgfXnzU"},{"type":"text","value":" en el Periodograma","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"Y4AHSqI5zh"}],"identifier":"independencia-de-la-varianza-al-aumento-de-n-en-el-periodograma","label":"Independencia de la varianza al aumento de N en el Periodograma","html_id":"independencia-de-la-varianza-al-aumento-de-n-en-el-periodograma","implicit":true,"key":"Kq00l2ywIh"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"El periodograma no reduce la varianza al aumentar ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"BXwgnLtrjU"},{"type":"inlineMath","value":"N","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"n3UmNQuyzy"},{"type":"text","value":" principalmente debido a:","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"Fh2e0OklHe"}],"key":"pGoSOUywvn"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"strong","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"Independencia espectral","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"hyuoeP6tiz"}],"key":"n237SBkEZC"},{"type":"text","value":":","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"wnbfay9px0"}],"key":"Dm5UhkPEgb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":106,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":106,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"El periodograma calcula la energía en cada frecuencia de forma independiente. Aunque ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"yYVHuIgdrV"},{"type":"inlineMath","value":"N","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"x4JjyLW5hE"},{"type":"text","value":" aumente, la estimación en ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"yWkeICmzgp"},{"type":"inlineMath","value":"f_1","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rDLJ9gxCGu"},{"type":"text","value":" no “aprende” de ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"XwOrp7ocYe"},{"type":"inlineMath","value":"f_2","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">f_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"wzPYkPZ4sl"},{"type":"text","value":".","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"hYCdyj2BCP"}],"key":"S5neBjHU5L"}],"key":"Oj5ra6gydg"},{"type":"listItem","spread":true,"position":{"start":{"line":108,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"strong","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"text","value":"Fugas espectrales","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"eHZ9vlriO3"}],"key":"RukNKrt92a"},{"type":"text","value":" (leakage): El enventanado implícito (rectangular) causa interferencia entre frecuencias, aumentando la varianza aparente. Welch mitiga esto:","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"o3whM49Nxo"}],"key":"EcwtHOkPSA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":109,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"Al usar ventanas (ej. Hann), reduce leakage en cada segmento.","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"sTjO5q7aZR"}],"key":"JEROWh5Wa1"},{"type":"listItem","spread":true,"position":{"start":{"line":110,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"El promediado atenúa las fluctuaciones aleatorias.","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"F5sxG8Ic4U"}],"key":"hUvkyHhrXP"}],"key":"BRXL4Rvy4y"}],"key":"ldoEeyEaoR"}],"key":"ke80KblYzx"}],"key":"Gs7IjjHpeW"},{"type":"block","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"Caso especial: Señales sin ruido","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"ZUs4FRRzPc"}],"identifier":"caso-especial-se-ales-sin-ruido","label":"Caso especial: Señales sin ruido","html_id":"caso-especial-se-ales-sin-ruido","implicit":true,"key":"R0KlSSQmsJ"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"Si la señal es determinística y libre de ruido (por ejemplo una senoide pura), aumentar ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"lMMd0X7oyW"},{"type":"inlineMath","value":"N","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"yG5xSU5fPi"},{"type":"text","value":" en el periodograma sí mejora la estimación, porque no hay varianza intrínseca. Pero en aplicaciones reales (ruido presente), Welch es casi siempre mejor.","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"zWdMKjzaYJ"}],"key":"jK9JPARRVb"}],"key":"OtcXq0ZPk8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Configuración\nfs = 1000  # Frecuencia de muestreo\nN = 10000  # Número de muestras (10 segundos)\nt = np.arange(N) / fs\n\n# Señal: tono débil + ruido fuerte\ntono = 0.04 * np.sin(2 * np.pi * 75 * t)  # Tono de 75 Hz (muy pequeño)\nrg = np.random.default_rng(seed=12345)\nruido = rg.random(N)                 # Ruido blanco (sigma=1)\nx = tono + ruido\n\n# Periodograma estándar\nf_per, pxx_per = periodogram(x, fs=fs, nfft=N)\n\n# Welch con parámetros óptimos\nf_wel, pxx_wel = welch(x, fs=fs, window=\"hamming\", nperseg=1024, noverlap=512, nfft=1024)\n\n# Gráficos\nplt.figure(figsize=(14, 6))\n\n# Periodograma\nplt.subplot(2, 1, 1)\nplt.semilogy(f_per, pxx_per)\n#plt.ylim(1e-8, 1e-1)\n#plt.xlim(10, 500)\nplt.title('Periodograma estándar\\nNo se distingue el tono a 75 Hz')\nplt.xlabel('Frecuencia (Hz)')\nplt.ylabel('PSD (V²/Hz)')\nplt.grid(True)\n\n# Welch\nplt.subplot(2, 1, 2)\nplt.semilogy(f_wel, pxx_wel)\n#plt.ylim(1e-3, 1e-2)\n#plt.xlim(10, 500)\nplt.title('Método de Welch\\nTono visible a 75 Hz (pico)')\nplt.xlabel('Frecuencia (Hz)')\nplt.grid(True)\n\nplt.tight_layout()\nplt.show()","key":"ciyGYhMGLc"},{"type":"output","id":"7hYi6vxgUQEYQUfSbN53F","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1400x600 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"613dac9648644a7a240649be0c43628c","path":"/build/613dac9648644a7a240649be0c43628c.png"}}}],"key":"Wji77sMwSd"}],"data":{},"key":"xrjkGIjB9u"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"Problemas para los alumnos","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"yfDzJRWE3z"}],"identifier":"problemas-para-los-alumnos","label":"Problemas para los alumnos","html_id":"problemas-para-los-alumnos","implicit":true,"key":"Y9v1ydpV4v"},{"type":"heading","depth":3,"position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"Problema 1","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"tmINV2Gyol"}],"identifier":"problema-1","label":"Problema 1","html_id":"problema-1","implicit":true,"key":"oWqjd98NJy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":166,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"children":[{"type":"text","value":"Generar una onda cudrada de media 0, frecuencia 50 Hz, amplitud máxima 0.1 y de 10 segundos de duración. Agregarle el mismo ruido que tiene la señal del ejemplo.","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"paeeldVUXP"}],"key":"Bq6peGGrln"},{"type":"listItem","spread":true,"position":{"start":{"line":167,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"text","value":"Tratar de obtener un Periodograma estándar y con Welch para analizar el contenido armónico de la señal.","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"Cg3C8HrstY"}],"key":"T7bchAOnj5"}],"key":"BlI7jVdku2"},{"type":"heading","depth":3,"position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"Problema 2","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"u9CvIBWEHH"}],"identifier":"problema-2","label":"Problema 2","html_id":"problema-2","implicit":true,"key":"RtDps9CumO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":171,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":171,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"Generar la siguiente señal.","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"eJ1xgXjrdx"}],"key":"igDQS4DyuS"}],"key":"mPGStuxQRE"},{"type":"code","lang":"python","value":"fs = 1000  # Hz, frecuencia de muestreo\nt = np.arange(0, 10, 1/fs)  # 10 segundos\nng = np.random.default_rng(seed=1234)\n# Señal: tono débil a 50 Hz + mucho ruido blanco\nsignal = 0.07 * np.sin(2 * np.pi * 50 * t) + ng.normal(0, 1, len(t))","position":{"start":{"line":173,"column":1},"end":{"line":179,"column":1}},"key":"GMgIGRrKW4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":181,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"Analizarlarla haciendo un análisis espectral de potencia mediante un periodograma estándard y mediante un periodograma con el método de Welch.k","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"GD2Jm8dbsf"}],"key":"xI8Q1msb90"},{"type":"listItem","spread":true,"position":{"start":{"line":182,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"Durante el curse hemos visto una herramienta de maroy utilidad para analizar esta señal. ¿De cual se trata? Escriba una script que la use y la grafique.","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"ZEEZ9VKOGs"}],"key":"dFdb4pEVz1"}],"key":"jPb30LARpS"}],"key":"wwUmFACgaq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"eFaJD0X0Cg"},{"type":"output","id":"dZN9Bu6Z_b8Y56o_zn0K6","data":[],"key":"V2N0ik5JHv"}],"data":{},"key":"cSGmgVblIn"}],"key":"NmCEscMsPO"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Análisis frecuencial de señales en tiempo discreto","url":"/recursos/nuevo-material/analisis-frecuencial-en-tiempo-discreto","group":"Laboratorio de Procesamineto Digital de Señales"},"next":{"title":"Sistemas dinámicos","url":"/recursos/nuevo-material/diapo-sistemas/diaposistemas","group":"Laboratorio de Procesamineto Digital de Señales"}}},"domain":"http://localhost:3006"}